<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[THM] Easy Peasy" /><meta property="og:locale" content="en" /><meta name="description" content="Infosec blog" /><meta property="og:description" content="Infosec blog" /><link rel="canonical" href="isntma.github.io/machines/thm/easypeasy" /><meta property="og:url" content="isntma.github.io/machines/thm/easypeasy" /><meta property="og:site_name" content="ISntMA" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-14T19:30:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[THM] Easy Peasy" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-15T10:33:57+01:00","datePublished":"2022-12-14T19:30:00+01:00","description":"Infosec blog","headline":"[THM] Easy Peasy","mainEntityOfPage":{"@type":"WebPage","@id":"isntma.github.io/machines/thm/easypeasy"},"url":"isntma.github.io/machines/thm/easypeasy"}</script><title>[THM] Easy Peasy | ISntMA</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ISntMA"><meta name="application-name" content="ISntMA"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ISntMA</a></div><div class="site-subtitle font-italic">Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/curso/" class="nav-link"> <i class="fa-fw fas fa-book-open ml-xl-3 mr-xl-3 unloaded"></i> <span>CURSO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/isntma" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://app.hackthebox.com/profile/987149" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/isntma" aria-label="tryhackme" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['isnt.ma','tuta.io'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[THM] Easy Peasy</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[THM] Easy Peasy</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/isntma">ISntMA</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1671042600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-12-14 </em> </span> <span> Updated <em class="timeago" data-ts="1676453637" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-02-15 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1466 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="/assets/img/machines/thm/easypeasy/banner.png" alt="banner" data-proofer-ignore></p><h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Para empezar veremos los puertos que tenemos accesibles, para esto usamos <strong>nmap</strong> a todos los puertos.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nmap <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-p-</span> <span class="nt">-oN</span> ports 10.10.93.173
<span class="go">Nmap scan report for 10.10.93.173
Host is up (0.089s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT      STATE SERVICE VERSION
80/tcp    open  http    nginx 1.16.1
| http-robots.txt: 1 disallowed entry 
|_/
|_http-title: Welcome to nginx!
|_http-server-header: nginx/1.16.1
</span><span class="gp">6498/tcp  open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux;</span><span class="w"> </span>protocol 2.0<span class="o">)</span>
<span class="go">| ssh-hostkey: 
|   2048 304a2b22acd95609f2da122057f46cd4 (RSA)
|   256 bf86c9c7b7ef8c8bb994ae0188c0854d (ECDSA)
|_  256 a172ef6c812913ef5a6c24034cfe3d0b (ED25519)
65524/tcp open  http    Apache httpd 2.4.43 ((Ubuntu))
| http-robots.txt: 1 disallowed entry 
|_/
|_http-title: Apache2 Debian Default Page: It works
|_http-server-header: Apache/2.4.43 (Ubuntu)
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><h3 id="fuzzing"><span class="mr-2">Fuzzing</span><a href="#fuzzing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Ahora realizamos fuzzing a los directorios después de ver que en <em>robots.txt</em> no hay nada interesante. La herramienta que usaré es <a href="https://github.com/ffuf/ffuf">ffuf</a>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>ffuf <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt <span class="nt">-u</span> http://10.10.226.197/FUZZ <span class="nt">-ic</span> <span class="nt">-c</span>   
<span class="go">
        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.5.0 Kali Exclusive &lt;3
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.226.197/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
________________________________________________

                        [Status: 200, Size: 612, Words: 79, Lines: 26, Duration: 54ms]
hidden                  [Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 49ms]
:: Progress: [22089/87651] :: Job [1/1] :: 429 req/sec :: Duration: [0:00:33] :: Errors: 0 :
</span></pre></table></code></div></div><blockquote><p>Vemos un directorio interesante…</p></blockquote><p>En ese directorio no se encontraba nada excepto una imagen. Seguiremos con <a href="https://github.com/ffuf/ffuf">ffuf</a>, pero esta vez haremos fuzzing dentro del directorio <em>/hidden</em>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>ffuf <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt <span class="nt">-u</span> http://10.10.226.197/hidden/FUZZ <span class="nt">-ic</span> <span class="nt">-c</span>
<span class="go">
        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.5.0 Kali Exclusive &lt;3
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.226.197/hidden/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
________________________________________________

                        [Status: 200, Size: 390, Words: 47, Lines: 19, Duration: 53ms]
whatever                [Status: 301, Size: 169, Words: 5, Lines: 8, Duration: 48ms]
:: Progress: [39589/87651] :: Job [1/1] :: 767 req/sec :: Duration: [0:00:53] :: Errors: 0 ::
</span></pre></table></code></div></div><blockquote><p>Aquí empezamos con cosas más llamativas en el <em>source code</em>.</p></blockquote><h2 id="foothold"><span class="mr-2">Foothold</span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="primera-flag"><span class="mr-2">Primera flag</span><a href="#primera-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Esta la encontraremos como he mencionado antes en el código fuente de la web, en concreto en el directorio <em>/hidden/whatever</em>.</p><p><img data-src="/assets/img/machines/thm/easypeasy/whatever-web.png" alt="whatever" data-proofer-ignore></p><blockquote><p>Es una simple imagen, pero si miramos el código…</p></blockquote><p>Aquí vemos una etiqueta con el atributo <strong>hidden</strong> el cuál contiene un texto encriptado en formato <strong>base64</strong>.</p><p><img data-src="/assets/img/machines/thm/easypeasy/source.png" alt="source-code" data-proofer-ignore></p><p>Para desencriptarlo lo haremos directamente con terminal de la siguiente forma.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"ZmxhZ3tmMXJzN19mbDRnfQ=="</span> | <span class="nb">base64</span> <span class="nt">-d</span>                                       
<span class="go">flag{**********}
</span></pre></table></code></div></div><h3 id="segunda-flag"><span class="mr-2">Segunda flag</span><a href="#segunda-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Aparte de esa primera página tenemos que recordar que con <strong>nmap</strong> también vimos que el servicio apache está abierto en el puerto 65524. Entraremos desde el navegador a ver si se encuentra algo.</p><p>Al entrar nos encontramos con el index por defecto de apache, revisaremos <em>robots.txt</em> y <em>código fuente</em>.</p><p><img data-src="/assets/img/machines/thm/easypeasy/apache.png" alt="apache" data-proofer-ignore></p><p>Dentro del fichero <em>robots.txt</em> tenemos algo que llama la atención como <em>User-Agent</em>.</p><div file="/robots.txt" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/robots.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>User-Agent:<span class="k">*</span>
Disallow:/
Robots Not Allowed
User-Agent:a18672860d0510e5ab6699730763b250
Allow:/
This Flag Can Enter But Only This Flag No More Exceptions
</pre></table></code></div></div><p>Ese hash lo copiaremos y lo pasaremos por <code class="language-plaintext highlighter-rouge">hash-identifier</code> para saber que tipo de hash estamos tratando.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>hash-identifier a18672860d0510e5ab6699730763b250                                
<span class="gp">   #</span><span class="c">########################################################################</span>
<span class="gp">   #</span><span class="w">     </span>__  __                     __           ______    _____           <span class="c">#</span>
<span class="gp">   #</span><span class="w">    </span>/<span class="se">\ \/\ \ </span>                  /<span class="se">\ \ </span>        /<span class="se">\_</span>_  _<span class="se">\ </span> /<span class="se">\ </span> _ <span class="sb">`</span><span class="se">\ </span>        <span class="c">#</span>
<span class="gp">   #</span><span class="w">    </span><span class="se">\ \ \_\ \ </span>    __      ____ <span class="se">\ \ \_</span>__     <span class="se">\/</span>_/<span class="se">\ \/</span>  <span class="se">\ \ \/\ \ </span>       <span class="c">#</span>
<span class="gp">   #</span><span class="w">     </span><span class="se">\ \ </span> _  <span class="se">\ </span> /<span class="s1">'__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #
</span><span class="gp">   #</span><span class="w">      </span><span class="s1">\ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #
</span><span class="gp">   #</span><span class="w">       </span><span class="s1">\ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #
</span><span class="gp">   #</span><span class="w">        </span><span class="s1">\/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #
</span><span class="gp">   #</span><span class="w">                                                             </span><span class="s1">By Zion3R #
</span><span class="gp">   #</span><span class="w">                                                    </span><span class="s1">www.Blackploit.com #
</span><span class="gp">   #</span><span class="w">                                                   </span><span class="s1">Root@Blackploit.com #
</span><span class="gp">   #</span><span class="s1">########################################################################
</span><span class="go">--------------------------------------------------

Possible Hashs:
[+] MD5
</span><span class="gp">[+] Domain Cached Credentials - MD4(MD4(($</span>pass<span class="o">))</span>.<span class="o">(</span>strtolower<span class="o">(</span><span class="nv">$username</span><span class="o">)))</span>
</pre></table></code></div></div><blockquote><p>Nos da 2 posibilidades pero la que es más común es el MD5.</p></blockquote><p>Si vamos probando por páginas de crack de hashes puede que nos lleve un rato por eso recomiendo que la búsqueda del hash sea directamente en el buscador. Así nos devolvera páginas de crackear hashes que ya la tengan registrada en la base de datos.</p><p><img data-src="/assets/img/machines/thm/easypeasy/duckduck.png" alt="duckduck" data-proofer-ignore></p><h3 id="tercera-flag"><span class="mr-2">Tercera flag</span><a href="#tercera-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Para esta será algo tan sencillo como hacer <em>CTRL+F</em> en el código fuente del index del apache, y buscar por ‘flag’. Directamente aparecerá en texto plano la flag para introducirla como tercera flag.</p><p><img data-src="/assets/img/machines/thm/easypeasy/flag3.png" alt="flag3" data-proofer-ignore></p><h3 id="cuarta-flag"><span class="mr-2">Cuarta flag</span><a href="#cuarta-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>En este caso seguiremos buscando en el código fuente y como para el anterior buscaremos, pero esta vez por ‘hidden’, con esto encontraremos otro párrafo oculto, contiene lo siguiente:</p><p><code class="language-plaintext highlighter-rouge">its encoded with ba....:ObsJmP173N2X6dOrAgEAL0Vu</code></p><p>Es otro texto en base, ahora es base62.</p><p>Para su desencriptación usaremos <a href="https://cyberchef.io">Cyberchef</a> la cuál es una muy buena página para temas de criptografía como este.</p><p><img data-src="/assets/img/machines/thm/easypeasy/cyberchef.png" alt="cyberchef" data-proofer-ignore></p><h3 id="quinta-flag"><span class="mr-2">Quinta flag</span><a href="#quinta-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Entrando al directorio encontrado en la cuarta “flag”, podemos ver lo siguiente:</p><p><img data-src="/assets/img/machines/thm/easypeasy/nothing.png" alt="nothing" data-proofer-ignore></p><p>Si le echamos un vistazo al <em>source code</em>, encontramos otro hash y una imagen.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;center&gt;</span>
<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"binarycodepixabay.jpg"</span> <span class="na">width=</span><span class="s">"140px"</span> <span class="na">height=</span><span class="s">"140px"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;p&gt;</span>940d71e8655ac41efb5f8ab850668505b86dd64186a66e57d1483e7f5fe6fd81<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/center&gt;</span>
</pre></table></code></div></div><p>Descargaremos la imagen y copiaremos el hash a un archivo para poder tratar de una mejor forma. La imagen la dejaremos para luego, ahora nos pondremos con el hash.</p><p>Introducimos el valor del hash en un archivo.</p><p><code class="language-plaintext highlighter-rouge">$ echo "940d71e8655ac41efb5f8ab850668505b86dd64186a66e57d1483e7f5fe6fd81" &gt; hash.txt</code></p><blockquote class="prompt-info"><div><p>En TryHackMe tendremos que descargar un diccionario que nos proporcionan</p></div></blockquote><p>Usaremos <code class="language-plaintext highlighter-rouge">john</code> para crackear este hash, el formato será GOST ya que no sabemos realmente con qué tratamos.</p><p>El comando y la salida de este es:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>john <span class="nt">--wordlist</span><span class="o">=</span>easypeasy.txt <span class="nt">--format</span><span class="o">=</span>gost hash.txt
<span class="go">Using default input encoding: UTF-8
Loaded 1 password hash (gost, GOST R 34.11-94 [64/64])
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
mypasswordforthatjob (?)     
1g 0:00:00:00 DONE (2022-12-15 08:52) 12.50g/s 51200p/s 51200c/s 51200C/s vgazoom4x..flash88
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
</span></pre></table></code></div></div><h3 id="sexta-flag"><span class="mr-2">Sexta flag</span><a href="#sexta-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Antes descargamos la imagen que había en el directorio oculto del Apache, ahora usaremos <code class="language-plaintext highlighter-rouge">steghide</code> porque lo más probable es que la anterior contraseña que hemos extraído del hash sea la <em>passphrase</em> de datos ocultos dentro de la imagen utilizado técnicas de esteganografía.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>steghide extract <span class="nt">-sf</span> flag.jpeg <span class="nt">-p</span> mypasswordforthatjob
<span class="go">wrote extracted data to "secrettext.txt".
</span></pre></table></code></div></div><p>Vemos como se ha extraído datos ocultos, este contiene lo siguiente:</p><div file="secrettext.txt" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="secrettext.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>username:boring
password:
01101001 01100011 01101111 01101110 01110110 01100101 01110010 01110100 01100101 01100100 01101101 01111001 01110000 01100001 01110011 01110011 01110111 01101111 01110010 01100100 01110100 01101111 01100010 01101001 01101110 01100001 01110010 01111001
</pre></table></code></div></div><p>Pasaremos el binario a texto en mi caso he usado <a href="https://binarytotext.net/">binarytotext.net</a>.</p><p><img data-src="/assets/img/machines/thm/easypeasy/binary.png" alt="binary" data-proofer-ignore></p><h3 id="séptima-flag"><span class="mr-2">Séptima flag</span><a href="#séptima-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Tendremos que iniciar ssh con las credenciales que tenemos, y revisar en la carpeta personal del usuario por la flag.</p><p><img data-src="/assets/img/machines/thm/easypeasy/ssh.png" alt="ssh" data-proofer-ignore></p><p>Vemos que viene una flag pero está rara, esta cifrada con Caesar con una rotación de 13 posiciones, también llamado ROT13. Si usamos <a href="https://www.dcode.fr/rot-13-cipher">dcode.fr</a> para desencriptarlo veremos que nos devuelve la flag.</p><p><img data-src="/assets/img/machines/thm/easypeasy/rot.png" alt="rot" data-proofer-ignore></p><p>Con esto habríamos completado todas las respuestas de la máquina excepto la última que se dejará para más adelante.</p><h3 id="privilege-escalation"><span class="mr-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Para esto revisaremos los puntos más básicos, como el <em>sudo -l</em>, directorio <em>/tmp</em> y en este caso el que nos va a dar la escalada va a ser el <em>crontab</em> de este sistema. Como podemos ver nos avisa de que se ejecutará como root todo lo que se ejecute vía crontab.</p><p><img data-src="/assets/img/machines/thm/easypeasy/crontab.png" alt="crontab" data-proofer-ignore></p><blockquote><p>En mi caso añado una reverse shell con <em>netcat</em>.</p></blockquote><p>Al dejar <em>netcat</em> escuchando y haber añadido la línea que genera la conexión a la reverse shell en crontab sólo quedará esperar.</p><p><img data-src="/assets/img/machines/thm/easypeasy/root.png" alt="root" data-proofer-ignore></p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Una máquina de iniciación que toca varias ramas al estilo CTF.</p><h3 id="techniques-and-tools"><span class="mr-2">Techniques and Tools</span><a href="#techniques-and-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ol><li>nmap<li>ffuf<li>steghide<li>john<li>RCE (Remote Code Execution)<li>PE (Privilege Escalation)</ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/machines/'>Machines</a>, <a href='/categories/thm/'>THM</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/machines/" class="post-tag no-text-decoration" >machines</a> <a href="/tags/ffuf/" class="post-tag no-text-decoration" >ffuf</a> <a href="/tags/curso/" class="post-tag no-text-decoration" >curso</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[THM] Easy Peasy - ISntMA&amp;url=isntma.github.io/machines/thm/easypeasy" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://t.me/share/url?url=isntma.github.io/machines/thm/easypeasy&amp;text=[THM] Easy Peasy - ISntMA" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/notes/brs/proyecto_8">[BRS] Proyecto 8</a><li><a href="/machines/thm/easypeasy">[THM] Easy Peasy</a><li><a href="/others/xssgame/Jefff">[XSSG] Jefff</a><li><a href="/others/xssgame/Ma-spaghet">[XSSG] Ma Spaghet!</a><li><a href="/others/xssgame/Ugandan-knuckles">[XSSG] Ugandan Knuckles</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/curso/">curso</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/tools/">tools</a> <a class="post-tag" href="/tags/warmups/">warmups</a> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/machines/thm/bountyhacker"><div class="card-body"> <em class="timeago small" data-ts="1673353800" > 2023-01-10 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[THM] Bounty Hacker</h3><div class="text-muted small"><p> Enumeration NMAP Como siempre iniciamos la máquina identificando puertos abiertos y servicios expuestos en la red. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29...</p></div></div></a></div><div class="card"> <a href="/machines/thm/lianyu"><div class="card-body"> <em class="timeago small" data-ts="1673973600" > 2023-01-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[THM] Lian_Yu</h3><div class="text-muted small"><p> Enumeration NMAP Identificamos puertos abiertos y servicios expuestos en la red. Esta vez con –top-ports para ver los más usados y aligerar el proceso. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 1...</p></div></div></a></div><div class="card"> <a href="/machines/htb/paper"><div class="card-body"> <em class="timeago small" data-ts="1652574240" > 2022-05-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[HTB] Paper</h3><div class="text-muted small"><p> Enumeration NMAP ┌──(kali㉿kali)-[~] └─$ nmap -sV 10.10.11.143 Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-14 05:07 EDT Nmap scan report for 10.10.11.143 Host is up (0.045s latency). Not ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/notes/web/Ffuf" class="btn btn-outline-primary" prompt="Older"><p>[Notes] Ffuf Cheatsheet</p></a> <a href="/machines/thm/bountyhacker" class="btn btn-outline-primary" prompt="Newer"><p>[THM] Bounty Hacker</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/isntma">ISntMA</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/machines/">machines</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/curso/">curso</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/tools/">tools</a> <a class="post-tag" href="/tags/warmups/">warmups</a> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/cheatsheet/">cheatsheet</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
